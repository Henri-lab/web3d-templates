# å†å²æ•…äº‹æ¨¡å— (module-culture-history)

> æ²‰æµ¸å¼ 3D å†å²æ•…äº‹å­¦ä¹ æ¨¡å—

## ğŸ“– æ¨¡å—æ¦‚è¿°

å†å²æ•…äº‹æ¨¡å—æ˜¯ä¸€ä¸ªæ²‰æµ¸å¼çš„ 3D å†å²æ•…äº‹å­¦ä¹ ä½“éªŒæ¨¡å—ï¼Œé€šè¿‡ Three.js æ¸²æŸ“å¼•æ“å’Œè‡ªå®šä¹‰ DSL è¯­è¨€ï¼Œå°†å†å²äº‹ä»¶ä»¥äº¤äº’å¼ 3D åœºæ™¯çš„å½¢å¼å‘ˆç°ç»™ç”¨æˆ·ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- âœ… **3D åœºæ™¯æ¸²æŸ“** - ä½¿ç”¨ Three.js æ¸²æŸ“å†å²åœºæ™¯
- âœ… **DSL è§£æ** - è‡ªå®šä¹‰å†å²æ•…äº‹ DSL è¯­è¨€
- âœ… **äº¤äº’å¼æ’­æ”¾** - æ”¯æŒæ’­æ”¾ã€æš‚åœã€å¿«è¿›ç­‰æ“ä½œ
- âœ… **åŠ¨ç”»ç³»ç»Ÿ** - ä¸°å¯Œçš„åœºæ™¯åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
- âœ… **éŸ³é¢‘æ”¯æŒ** - èƒŒæ™¯éŸ³ä¹å’ŒéŸ³æ•ˆ
- âœ… **æ•…äº‹ç®¡ç†** - æ•…äº‹é€‰æ‹©ã€è¿›åº¦ä¿å­˜ç­‰

## ğŸ¯ æ¨¡å—ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| æ¨¡å— ID | `story` |
| æ¨¡å—åç§° | å†å²æ•…äº‹ |
| ç‰ˆæœ¬ | 1.0.0 |
| ç±»å‹ | local |
| å‘½åç©ºé—´ | `story` |

## ğŸ“‚ ç›®å½•ç»“æ„

```
moduleMDs/module-culture-history/
â”œâ”€â”€ README.md                           # æœ¬æ–‡ä»¶ - æ¨¡å—æ¦‚è¿°
â”œâ”€â”€ layers/                             # åˆ†å±‚æ¶æ„æ–‡æ¡£
â”‚   â”œâ”€â”€ 01-infrastructure/              # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”œâ”€â”€ 02-code/                        # ä»£ç å±‚
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”œâ”€â”€ 03-content/                     # å†…å®¹å±‚
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”œâ”€â”€ 04-business/                    # ä¸šåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â””â”€â”€ flowcharts/
â”‚   â”‚       â””â”€â”€ page-lifecycle.md
â”‚   â”œâ”€â”€ 05-animation/                   # åŠ¨ç”»å±‚
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â””â”€â”€ presets/
â”‚   â””â”€â”€ 06-ui-design/                   # UI è®¾è®¡å±‚
â”‚       â”œâ”€â”€ README.md
â”‚       â””â”€â”€ themes/
â”‚
â”œâ”€â”€ history-dsl/                        # DSL ç³»ç»Ÿæ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                       # DSL æ¦‚è¿°
â”‚   â”œâ”€â”€ SYSTEM-OVERVIEW.txt             # ç³»ç»Ÿæ€»è§ˆ
â”‚   â”œâ”€â”€ syntax/                         # è¯­æ³•æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ DSL-SYNTAX.md               # è¯­æ³•è§„èŒƒ
â”‚   â”‚   â””â”€â”€ CONTENT-ORGANIZATION.md     # å†…å®¹ç»„ç»‡
â”‚   â”œâ”€â”€ parser/                         # è§£æå™¨æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ PARSER-ARCHITECTURE.md      # è§£æå™¨æ¶æ„
â”‚   â””â”€â”€ examples/                       # ç¤ºä¾‹
â”‚       â””â”€â”€ 01-qin-unification.story.md # ç§¦ç»Ÿä¸€ç¤ºä¾‹
â”‚
â”œâ”€â”€ plugins/                            # æ’ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ README.md                       # æ’ä»¶æ¦‚è¿°
â”‚   â””â”€â”€ catalog/                        # æ’ä»¶ç›®å½•
â”‚
â””â”€â”€ public/                             # å…¬å…±èµ„æº
    â”œâ”€â”€ stories/                        # æ•…äº‹æ–‡ä»¶
    â”‚   â””â”€â”€ qin-unification.story.md
    â”œâ”€â”€ models/                         # 3D æ¨¡å‹
    â”œâ”€â”€ images/                         # å›¾ç‰‡èµ„æº
    â”œâ”€â”€ audio/                          # éŸ³é¢‘èµ„æº
    â””â”€â”€ favicon.svg
```

## ğŸ—ï¸ æ¨¡å—æ¶æ„

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI è®¾è®¡å±‚ (06)                        â”‚
â”‚  - ä¸»é¢˜ç³»ç»Ÿ                                              â”‚
â”‚  - ç»„ä»¶æ ·å¼                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŠ¨ç”»å±‚ (05)                           â”‚
â”‚  - åœºæ™¯åŠ¨ç”»                                              â”‚
â”‚  - è¿‡æ¸¡æ•ˆæœ                                              â”‚
â”‚  - åŠ¨ç”»é¢„è®¾                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡å±‚ (04)                           â”‚
â”‚  - æ•…äº‹æ’­æ”¾é€»è¾‘                                          â”‚
â”‚  - ç”¨æˆ·äº¤äº’                                              â”‚
â”‚  - çŠ¶æ€ç®¡ç†                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å†…å®¹å±‚ (03)                           â”‚
â”‚  - DSL è§£æ                                              â”‚
â”‚  - æ•…äº‹æ•°æ®                                              â”‚
â”‚  - å†…å®¹æ¨¡æ¿                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»£ç å±‚ (02)                           â”‚
â”‚  - React ç»„ä»¶                                            â”‚
â”‚  - Three.js åœºæ™¯                                         â”‚
â”‚  - å·¥å…·å‡½æ•°                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åŸºç¡€è®¾æ–½å±‚ (01)                         â”‚
â”‚  - Three.js                                              â”‚
â”‚  - React Three Fiber                                     â”‚
â”‚  - å¹³å° API                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è®¿é—®æ¨¡å—

```
http://localhost:5173/stories      # æ•…äº‹é€‰æ‹©é¡µ
http://localhost:5173/story/:id    # æ•…äº‹æ’­æ”¾é¡µ
```

### æ¨¡å—é…ç½®

```typescript
// src/platform/config/platform.config.ts
{
  id: 'story',
  name: 'å†å²æ•…äº‹',
  description: 'æ²‰æµ¸å¼3Då†å²æ•…äº‹å­¦ä¹ ',
  version: '1.0.0',
  type: 'local',

  routes: [
    {
      path: '/stories',
      component: 'StorySelectionPage',
      meta: { title: 'é€‰æ‹©æ•…äº‹' },
    },
    {
      path: '/story/:storyId',
      component: 'StoryPlayerPage',
      meta: { title: 'æ•…äº‹æ’­æ”¾' },
    },
  ],

  menu: {
    title: 'å†å²æ•…äº‹',
    icon: 'book',
    order: 1,
    visible: true,
  },

  capabilities: {
    provides: ['story.play', 'story.pause'],
    requires: ['platform.eventBus'],
  },

  config: { maxStories: 100 },
  state: { namespace: 'story', persist: true },
}
```

## ğŸ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. æ•…äº‹é€‰æ‹©

ç”¨æˆ·å¯ä»¥æµè§ˆå’Œé€‰æ‹©ä¸åŒçš„å†å²æ•…äº‹ã€‚

**é¡µé¢**: `StorySelectionPage.tsx`

**åŠŸèƒ½**:
- æ˜¾ç¤ºæ•…äº‹åˆ—è¡¨
- æ•…äº‹é¢„è§ˆ
- æ•…äº‹æœç´¢å’Œç­›é€‰
- æ•…äº‹æ”¶è—

### 2. æ•…äº‹æ’­æ”¾

æ²‰æµ¸å¼çš„ 3D æ•…äº‹æ’­æ”¾ä½“éªŒã€‚

**é¡µé¢**: `StoryPlayerPage.tsx`

**åŠŸèƒ½**:
- 3D åœºæ™¯æ¸²æŸ“
- æ•…äº‹å‰§æƒ…æ’­æ”¾
- äº¤äº’å¼æ§åˆ¶ï¼ˆæ’­æ”¾ã€æš‚åœã€å¿«è¿›ï¼‰
- è¿›åº¦ä¿å­˜

### 3. DSL è§£æ

è‡ªå®šä¹‰çš„å†å²æ•…äº‹ DSL è¯­è¨€ã€‚

**æ–‡æ¡£**: [history-dsl/README.md](./history-dsl/README.md)

**åŠŸèƒ½**:
- åœºæ™¯å®šä¹‰
- è§’è‰²å®šä¹‰
- äº‹ä»¶å®šä¹‰
- åŠ¨ç”»å®šä¹‰

### 4. 3D æ¸²æŸ“

åŸºäº Three.js çš„ 3D åœºæ™¯æ¸²æŸ“ã€‚

**æŠ€æœ¯æ ˆ**:
- Three.js
- React Three Fiber
- React Three Drei

## ğŸ”Œ äº‹ä»¶ç³»ç»Ÿ

### å‘é€çš„äº‹ä»¶

| äº‹ä»¶ç±»å‹ | è¯´æ˜ | Payload |
|---------|------|---------|
| `story:play` | å¼€å§‹æ’­æ”¾æ•…äº‹ | `{ storyId: string }` |
| `story:pause` | æš‚åœæ•…äº‹ | `{ storyId: string }` |
| `story:resume` | ç»§ç»­æ’­æ”¾ | `{ storyId: string }` |
| `story:end` | æ•…äº‹ç»“æŸ | `{ storyId: string }` |
| `story:progress` | æ’­æ”¾è¿›åº¦ | `{ storyId: string, progress: number }` |

### ç›‘å¬çš„äº‹ä»¶

| äº‹ä»¶ç±»å‹ | è¯´æ˜ | å¤„ç†é€»è¾‘ |
|---------|------|---------|
| `platform:ready` | å¹³å°å°±ç»ª | åˆå§‹åŒ–æ¨¡å— |
| `route:change` | è·¯ç”±å˜åŒ– | æ›´æ–°æ¨¡å—çŠ¶æ€ |

## ğŸ’¾ çŠ¶æ€ç®¡ç†

### æ¨¡å—çŠ¶æ€

```typescript
interface StoryState {
  currentStory: Story | null
  isPlaying: boolean
  progress: number
  favorites: string[]
  history: string[]
}
```

### çŠ¶æ€æŒä¹…åŒ–

æ¨¡å—çŠ¶æ€ä¼šè‡ªåŠ¨æŒä¹…åŒ–åˆ° localStorageï¼š

```typescript
{
  namespace: 'story',
  persist: true,
}
```

## ğŸ“ DSL è¯­æ³•

### åŸºæœ¬ç»“æ„

```markdown
# æ•…äº‹æ ‡é¢˜

## åœºæ™¯ 1: åœºæ™¯åç§°

### è§’è‰²
- è§’è‰² A
- è§’è‰² B

### äº‹ä»¶
1. äº‹ä»¶æè¿° 1
2. äº‹ä»¶æè¿° 2

### åŠ¨ç”»
- åŠ¨ç”» 1
- åŠ¨ç”» 2
```

### ç¤ºä¾‹

æŸ¥çœ‹ [qin-unification.story.md](./public/stories/qin-unification.story.md) äº†è§£å®Œæ•´ç¤ºä¾‹ã€‚

## ğŸ¯ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æ•…äº‹

1. åœ¨ `public/stories/` ç›®å½•ä¸‹åˆ›å»º `.story.md` æ–‡ä»¶
2. ä½¿ç”¨ DSL è¯­æ³•ç¼–å†™æ•…äº‹å†…å®¹
3. æ·»åŠ å¿…è¦çš„ 3D æ¨¡å‹å’Œèµ„æº
4. åœ¨æ•…äº‹åˆ—è¡¨ä¸­æ³¨å†Œæ–°æ•…äº‹

### è‡ªå®šä¹‰åŠ¨ç”»

1. åœ¨ `layers/05-animation/presets/` ä¸­å®šä¹‰åŠ¨ç”»é¢„è®¾
2. åœ¨ DSL ä¸­å¼•ç”¨åŠ¨ç”»é¢„è®¾
3. åœ¨ä»£ç ä¸­å®ç°åŠ¨ç”»é€»è¾‘

### æ‰©å±• DSL

1. åœ¨ `history-dsl/syntax/` ä¸­å®šä¹‰æ–°è¯­æ³•
2. åœ¨ `history-dsl/parser/` ä¸­å®ç°è§£æå™¨
3. æ›´æ–°æ–‡æ¡£å’Œç¤ºä¾‹

## ğŸ› è°ƒè¯•

### æŸ¥çœ‹æ¨¡å—çŠ¶æ€

```typescript
import { useStoryStore } from '@/stores/storyStore'

const state = useStoryStore.getState()
console.log('Story state:', state)
```

### ç›‘å¬æ¨¡å—äº‹ä»¶

```typescript
import { globalEventBus } from '@platform/core'

globalEventBus.onAll((event) => {
  if (event.type.startsWith('story:')) {
    console.log('Story event:', event)
  }
})
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

### åˆ†å±‚æ¶æ„

1. [åŸºç¡€è®¾æ–½å±‚](./layers/01-infrastructure/README.md)
2. [ä»£ç å±‚](./layers/02-code/README.md)
3. [å†…å®¹å±‚](./layers/03-content/README.md)
4. [ä¸šåŠ¡å±‚](./layers/04-business/README.md)
5. [åŠ¨ç”»å±‚](./layers/05-animation/README.md)
6. [UI è®¾è®¡å±‚](./layers/06-ui-design/README.md)

### DSL ç³»ç»Ÿ

1. [DSL æ¦‚è¿°](./history-dsl/README.md)
2. [DSL è¯­æ³•](./history-dsl/syntax/DSL-SYNTAX.md)
3. [è§£æå™¨æ¶æ„](./history-dsl/parser/PARSER-ARCHITECTURE.md)
4. [ç¤ºä¾‹æ•…äº‹](./history-dsl/examples/01-qin-unification.story.md)

### æ’ä»¶ç³»ç»Ÿ

1. [æ’ä»¶æ¦‚è¿°](./plugins/README.md)
2. [æ’ä»¶ç›®å½•](./plugins/catalog/)

## ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.0.0** (2026-01-10) - åˆå§‹ç‰ˆæœ¬
  - åŸºç¡€æ•…äº‹æ’­æ”¾åŠŸèƒ½
  - DSL è§£æå™¨
  - 3D åœºæ™¯æ¸²æŸ“
  - æ•…äº‹é€‰æ‹©å’Œç®¡ç†

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æœ€åæ›´æ–°**: 2026-01-10
**ç»´æŠ¤è€…**: Development Team
